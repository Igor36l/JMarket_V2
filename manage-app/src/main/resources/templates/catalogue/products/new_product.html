<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Новый товар &ndash; JMarket</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
</head>
<body>
<div th:replace="catalogue/products/navigation :: nav"></div>
<h1>Новый товар</h1>
<div data-th-if="${errors}">
  <h2>Допущены ошибки</h2>
  <ul>
    <li data-th-each="error: ${errors}" data-th-text="${error}"></li>
  </ul>
</div>
<form method="post" data-th-action="@{/catalogue/products/create}">
  <label>
    Название:<br>
    <input type="text" name="title" data-th-value="${payload?.title}">
  </label><br>
  <label>
    Описание:<br>
    <textarea name="details" data-th-text="${payload?.details}"></textarea>
  </label><br>
  <button type="submit">Создать</button><br>
</form>
<form method="post" enctype="multipart/form-data" data-th-action="@{/catalogue/products/images}">
  <label>
    Загрузите изображение:<br>
    <input type="file" name="file">
  </label><br>

  <div data-th-if="${productImages}">
    <h3>Загруженные фотографии:</h3>
    <ul>
      <li data-th-each="image: ${productImages}" data-th-text="${image}"></li>
    </ul>
  </div>
  <div data-th-if="${imagePath}">
  <img data-th-each="img: ${imagePath}" th:src="@{/imgs/{img}(img=${img})}" width="200" height="200" alt="изображение">
  </div>
  <button type="submit">Загрузить</button>
</form>

<div th:if="${imagePath != null}">
  <img data-th-each="img: ${imagePath}" th:src="@{/imgs/{img}(img=${img})}" width="200" height="200"
       th:alt="Image"
       th:onerror="'alert(\'Ошибка загрузки изображения\');'">
</div>

<script>
  // Обработка ошибки загрузки изображения
  window.onerror = function (msg, url, lineNo, columnNo, error) {
    if (msg.includes('Failed to load resource')) {
      // Скрыть контейнер изображения
      document.getElementById('image-container').style.display = 'none';
      // ... Вы можете добавить альтернативное изображение
    }
  };
</script>
</body>
</html>